The major problems i faced was redeclaring variable which are causing conflict.
And i solved it by renaming it which fixed the conflict and allowed the code to work perfectly.